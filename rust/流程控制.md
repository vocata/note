# 流程控制

## 分支控制

### if-else语句

和和大多数语言的使用基本一样

```rust
if conditionA {
    // Do A
} else if conditionB {
    // Do B
} else {
    // Do other
}
```

在语句和表达式中曾提到过，if-else语句块也可以是表达式，但是有两个要求

1. 每个分支的最后必须为表达式
2. 每个分支的表达式求值结果类型要相同

## 循环控制

### for语句

for循环语句可以对诸如列表的这种实现了Iterator trait的类型进行遍历，for循环会隐式调用.iter()或者.into_iter()方法，前者会返回引用类型迭代器，迭代器只引用了列表中元素，后者则是返回新的迭代器，原可迭代对象的所有权发生转移。

```rust
let countries = [String::from("China"), String::from("America")];
for country in countries {     // countries.into_iter(), 'countries' value is borrowed here
    println!("{}", country);   // country: String
}

println!("{:#?}", countries);  // compile error
```

```rust
let countries = [String::from("China"), String::from("America")];
for country in &countries {   // countries.iter(), 'countries' value is moved here
    println!("{}", country);  // country: &String
}

println!("{:#?}", countries); // ok
```

如果想同时获取索引和值，可以使用enumerate()方法

```rust
let numbers = [1, 2, 3];
let mut pows = [0; 3];
for (i, num) in numbers.iter().enumerate() {
    pows[i] = num * num;
}

println!("{:#?}", pows);
```

### while语句

while可以带一个条件判断语句，使用上基本和其他语言没有什么区别，不再赘述

```rust
let (mut sum, mut counter) = (0, 0);

while counter < 100 {
    counter += 1;
    sum += counter;
}

println!("the sum of 1-100 is {}", sum);
```

### loop语句

loop不带任何语句，表示一个无限循环，需要跳出循环只能使用break语句。

```rust
let mut counter = 0;

let result = loop {
    counter += 1;

    if counter == 10 {
        break counter * 2;
    }
};

println!("the result is {}", result);
```

> 只有loop循环语句块才支持使用break语句返回值，此时loop循环语句块将成为一个表达式

### 标签

如果需要操作深层嵌套的控制逻辑，可以使用标签，并结合break和continue语句来做跳转

```rust
let mut count = 0;
'outer: loop {
    'inner: loop {
        if count >= 20 {
            // 跳出'inner标签指定的loop循环，程序跳到`count+=5;`这一行
            break 'inner;
        }
        count += 2;
    }

    count += 5;

    loop {
        if count >= 30 {
            // 跳出'outer标签指定的最外层loop循环，程序结束
            break 'outer;
        }
        // 继续执行'outer指定的最外层循环，程序跳转到`'inner: loop {`这一行
        continue 'outer;
    }
}

assert!(count == 30)
```
