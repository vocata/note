# 字符串与切片

## 原始字符串类型str

rust原生的字符串类型为str，其本上是数组切片[u8]，因此str也叫做字符串切片。通常情况下是无法直接使用str，需要通过字符串切片的不可变引用&str来使用，因此也称&str为字符串切片（引用）

> - 字符串字面值常量的类型就是&str，由于字符串字面值常量存放在代码段，因此是无法修改的，所以字符串字面值常量默认类型就是字符串切片的不可变引用
> - 一般rust书籍中常说的字符串切片实际上是指字符串切片引用

## 标准库字符串类型String

String类型原生字符串类型str更加灵活，其底层存储了一个指向堆内存的指针，用于程序运行时存储变长字符串，同时提供了大量的字符串操作方法，提高了字符串的处理效率。

另外，标准库还提供了其他的字符串类型，例如OsString等

## 切片

谈到切片，就得说明一下其和数组之间的区别。数组的长度是在编译期确定的，其类型为[T; N]，例如长度为3的整型数组类型为[i32; 3]。而切片长度则是不确定的，只是一个连续的内存空间，其类型为[T]，如[i32]。和字符串切片一样，切片通常是以引用的方式出现，比如以下例子

```rust
let arr: [i32; 3] = [1, 2, 3];  // 长度为3的数组

let end = 1;
let arr_slice: [i32] = &arr[0..end]; // 切片引用，长度在运行时确定
```

切片引用和切片的区别在于，切片引用除了包含指向内存地址的指针外，还包含长度（胖指针）。在rust中，由于不能确定切片的长度，因此无法直接使用切片类型，所以通常都是使用切片引用，切片引用的长度是在运行时确定的

> 字符串切片str实际上和普通的切片类型无异，底层实际上时utf-8编码的数组切片[u8]。由于切片无法确定长度，在rsut里这种类型称为[动态尺寸类型](https://rustwiki.org/zh-CN/reference/dynamically-sized-types.html)（DST，dynamically sized type），DST类型的引用（胖指针）和固定长度类型引用的区别在于，DST引用除了包含对象地址外，还包含了长度。

